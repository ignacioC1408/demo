<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administración de Productos - Punto Fácil</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="icon" href="/images/logo.png" type="image/png">
    <link rel="stylesheet" href="/css/productos.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg">
        <div class="container-fluid">
            <a class="navbar-brand d-flex align-items-center" href="/empleado/panel/inicio">
                <img src="/images/logo.png" alt="Punto Fácil" width="40" height="40" class="me-2">
                <span>Punto Fácil</span>
            </a>
            <div class="nav-links">
                <a href="/empleado/panel/inicio">🏠 Inicio</a>
                <a href="/empleado/panel/ventas">💰 Ventas</a>
                <a href="/empleado/panel/stock">📦 Stock</a>
                <a href="/empleado/productos" class="active">🛒 Productos</a>
            </div>
        </div>
    </nav>

    <main class="container">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="page-title">Gestión de Productos</h1>
            <a href="/empleado/productos/nuevo" class="btn-new">
                <span>+</span>
                Agregar Nuevo Producto
            </a>
        </div>

        <div class="table-container">
            <table class="products-table">
                <thead>
                    <tr>
                        <th scope="col">Código</th>
                        <th scope="col">Nombre</th>
                        <th scope="col">Precio</th>
                        <th scope="col">Stock</th>
                        <th scope="col">Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Productos existentes -->
                    <tr th:each="p : ${productos}" 
                        th:classappend="${p.stock == 0} ? 'stock-empty' : (${p.stock < 10} ? 'stock-low' : '')">
                        <td th:text="${p.codigoProducto}"></td>
                        <td th:text="${p.nombre}"></td>
                        <td th:text="'$' + ${#numbers.formatDecimal(p.precioBase, 1, 2, 'COMMA')}"></td>
                        <td>
                            <span th:class="${p.stock == 0} ? 'stock-badge empty' : (${p.stock < 10} ? 'stock-badge low' : 'stock-badge normal')" 
                                  th:text="${p.stock}"></span>
                        </td>
                        <td>
                            <div class="action-buttons">
                                <a th:href="@{'/empleado/productos/editar/' + ${p.id}}" class="btn-action btn-edit">
                                    Editar
                                </a>
                                <form th:action="@{'/empleado/productos/borrar/' + ${p.id}}" method="post" 
                                      onsubmit="return confirm('¿Está seguro de que desea eliminar este producto?');">
                                    <button type="submit" class="btn-action btn-delete">
                                        Borrar
                                    </button>
                                </form>
                            </div>
                        </td>
                    </tr>
                    
                    <!-- Estado vacío -->
                    <tr th:if="${#lists.isEmpty(productos)}">
                        <td colspan="5" class="empty-state">
                            <div class="empty-content">
                                <div class="empty-icon"></div>
                                <h3>No hay productos registrados</h3>
                                <p>Comienza agregando tu primer producto al sistema.</p>
                                <a href="/empleado/productos/nuevo" class="btn-new">Agregar Primer Producto</a>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </main>

    <footer class="page-footer">
        <p>&copy; 2025 Punto Fácil. Todos los derechos reservados.</p>
    </footer>
</body>
</html>